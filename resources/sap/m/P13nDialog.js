/*!
 * SAP UI development toolkit for HTML5 (SAPUI5/OpenUI5)
 * (c) Copyright 2009-2014 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['jquery.sap.global','./Dialog','./IconTabBar','./IconTabFilter','./P13nDialogRenderer','./library','sap/ui/core/EnabledPropagator','jquery.sap.xml'],function(q,D,I,a,P,l,E){"use strict";var b=D.extend("sap.m.P13nDialog",{metadata:{library:"sap.m",properties:{showReset:{type:"boolean",group:"Appearance",defaultValue:false}},aggregations:{panels:{type:"sap.m.P13nPanel",multiple:true,singularName:"panel",bindable:"bindable"}},events:{ok:{},cancel:{},reset:{}}}});E.apply(b.prototype,[true]);b.prototype.init=function(e){this.addStyleClass("sapMP13nDialog");D.prototype.init.apply(this,arguments);this._oResourceBundle=sap.ui.getCore().getLibraryResourceBundle("sap.m");this._initDialog()};b.prototype._initDialog=function(){var t=this;this.setContentWidth("50rem");this.setContentHeight("40rem");this.setSubHeader(new sap.m.Bar({contentLeft:[new sap.m.SegmentedButton({select:function(e){var B=e.getParameter("button");t._switchPanel(B)},width:'100%'})]}));this.setTitle(this._oResourceBundle.getText("P13NDIALOG_VIEW_SETTINGS"));this.addButton(new sap.m.Button({text:this._oResourceBundle.getText("P13NDIALOG_OK"),press:function(){t.fireOk()}}));this.addButton(new sap.m.Button({text:this._oResourceBundle.getText("P13NDIALOG_CANCEL"),press:function(){t.fireCancel()}}));this._oResetButton=new sap.m.Button({text:this._oResourceBundle.getText("P13NDIALOG_RESET"),visible:this.getShowReset(),press:function(){t.fireReset({})}});this.addButton(this._oResetButton)};b.prototype.setShowReset=function(s){this._oResetButton.setVisible(s)};b.prototype.addPanel=function(p){this.addAggregation("panels",p);if(this._getSegmentedButton()){var B=this._mapPanelToButton(p);this._getSegmentedButton().addButton(B);this._setDialogTitleFor(p,this.getContent().length);var v=false;if(this.getContent().length===1){v=true}p.setVisible(v);if(v){this.setVerticalScrolling(p.getVerticalScrolling())}this.getSubHeader().getContentLeft()[0].setVisible(!v)}return this};b.prototype.insertPanel=function(p,i){this.insertAggregation("panels",p,i);if(this._getSegmentedButton()){var B=this._mapPanelToButton(p);this._getSegmentedButton().insertButton(B);var v=false;if(this.getContent().length===1){v=true}p.setVisible(v);if(v){this.setVerticalScrolling(p.getVerticalScrolling())}}return this};b.prototype.removePanel=function(p){p=this.removeAggregation("panels",p);if(this._getSegmentedButton()){this._getSegmentedButton().removeButton(p&&p.data(P.CSS_CLASS+"Button"))}return p};b.prototype.removeAllPanels=function(){var p=this.removeAllAggregation("panels");if(this._getSegmentedButton()){this._getSegmentedButton().removeAllButtons()}return p};b.prototype._getSegmentedButton=function(){return this.getSubHeader().getContentLeft()[0]};b.prototype._mapPanelToButton=function(p){if(!p){return null}var B=new sap.m.Button({type:sap.m.ButtonType.Default,text:p.getBindingPath("title")?"{"+p.getBindingPath("title")+"}":p.getTitle()});B.setModel(p.getModel());p.data(P.CSS_CLASS+"Button",B);this.addContent(p);return B};b.prototype._switchPanel=function(B){var p=this._getPanelByButton(B);this.setVerticalScrolling(p.getVerticalScrolling());this.getContent().forEach(function(o){if(o===p){o.setVisible(true)}else{o.setVisible(false)}},this);this.invalidate();this.rerender()};b.prototype._getPanelByButton=function(B){for(var i=0,p=this.getContent(),c=p.length;i<c;i++){if(p[i].data(P.CSS_CLASS+"Button")===B){return p[i]}}return null};b.prototype._setDialogTitleFor=function(p,i){if(i>1){this.setTitle(this._oResourceBundle.getText("P13NDIALOG_VIEW_SETTINGS"));return}switch(p.getType()){case sap.m.P13nPanelType.filter:this.setTitle(this._oResourceBundle.getText("P13NDIALOG_TITLE_FILTER"));break;case sap.m.P13nPanelType.sort:this.setTitle(this._oResourceBundle.getText("P13NDIALOG_TITLE_SORT"));break;case sap.m.P13nPanelType.group:this.setTitle(this._oResourceBundle.getText("P13NDIALOG_TITLE_GROUP"));break;case sap.m.P13nPanelType.columns:this.setTitle(this._oResourceBundle.getText("P13NDIALOG_TITLE_COLUMNS"));break;default:this.setTitle(this._oResourceBundle.getText("P13NDIALOG_VIEW_SETTINGS"))}};b.prototype.exit=function(){D.prototype.exit.apply(this,arguments);if(this.getSubHeader()){this.getSubHeader().destroy()}};return b},true);
